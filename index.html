<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Batman Drawing Animation</title>
   <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
            overflow: hidden;
        }

        .container {
            width: 360px;
            height: 640px;
            position: relative;
            background: linear-gradient(145deg, #f8f8f8 0%, #e8e8e8 100%);
            border-radius: 20px;
            box-shadow: 
                0 20px 60px rgba(0,0,0,0.3),
                inset 0 1px 3px rgba(255,255,255,0.6);
            overflow: hidden;
        }

        .paper {
            width: 100%;
            height: 100%;
            background: #fefefe;
            position: relative;
            border-radius: 20px;
        }

        .paper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, 
                    transparent 0%, 
                    transparent 39px, 
                    #ff6b6b 39px, 
                    #ff6b6b 41px, 
                    transparent 41px, 
                    transparent 100%),
                repeating-linear-gradient(
                    transparent,
                    transparent 31px,
                    #e3f2fd 31px,
                    #e3f2fd 32px
                );
            border-radius: 20px;
            pointer-events: none;
        }

        .paper::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 15% 85%, rgba(0,0,0,0.015) 0%, transparent 40%),
                radial-gradient(circle at 85% 15%, rgba(0,0,0,0.01) 0%, transparent 40%),
                linear-gradient(135deg, rgba(255,255,255,0.3) 0%, transparent 30%);
            border-radius: 20px;
            pointer-events: none;
        }

        .book-spine {
            position: absolute;
            left: 0;
            top: 0;
            width: 20px;
            height: 100%;
            background: linear-gradient(90deg, 
                rgba(0,0,0,0.1) 0%, 
                rgba(0,0,0,0.05) 30%, 
                transparent 100%);
            border-radius: 20px 0 0 20px;
        }

        .book-holes {
            position: absolute;
            left: 25px;
            top: 0;
            width: 2px;
            height: 100%;
            background: 
                repeating-linear-gradient(
                    transparent,
                    transparent 45px,
                    #d0d0d0 45px,
                    #d0d0d0 50px,
                    transparent 50px,
                    transparent 65px
                );
        }

        .batman-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: 900;
            color: #1a1a1a;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            letter-spacing: 2px;
            font-family: 'Impact', 'Arial Black', sans-serif;
            z-index: 5;
            opacity: 0.9;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 20px;
            cursor: crosshair;
        }

        .pencil {
            position: absolute;
            width: 180px;
            height: 12px;
            background: 
                linear-gradient(90deg, 
                    #2c3e50 0%, 
                    #34495e 8%, 
                    #ecf0f1 8%, 
                    #bdc3c7 10%, 
                    #f39c12 10%, 
                    #e67e22 82%, 
                    #d35400 82%, 
                    #c0392b 88%, 
                    #a93226 100%);
            border-radius: 6px;
            box-shadow: 
                0 8px 25px rgba(0,0,0,0.3),
                0 4px 10px rgba(0,0,0,0.2),
                inset 0 2px 4px rgba(255,255,255,0.3),
                inset 0 -2px 4px rgba(0,0,0,0.1);
            transform-origin: 100% 50%;
            opacity: 1;
            z-index: 10;
            position: absolute;
            top: 100px;
            right: -50px;
            transform: rotate(-15deg);
        }

        .pencil::before {
            content: '';
            position: absolute;
            right: -12px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 12px solid #8b4513;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.4));
        }

        .pencil::after {
            content: '';
            position: absolute;
            right: -16px;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, #2c3e50 0%, #1a252f 100%);
            border-radius: 50%;
            box-shadow: 0 0 4px rgba(0,0,0,0.6);
        }

        .pencil-brand {
            position: absolute;
            left: 25px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 7px;
            font-weight: 700;
            color: #2c3e50;
            text-shadow: 0 1px 1px rgba(255,255,255,0.8);
            letter-spacing: 0.5px;
            font-family: 'Arial', sans-serif;
        }

        .pencil-ferrule {
            position: absolute;
            right: 32px;
            top: 0;
            width: 16px;
            height: 12px;
            background: 
                linear-gradient(90deg, 
                    #bdc3c7 0%, 
                    #ecf0f1 20%, 
                    #bdc3c7 40%, 
                    #95a5a6 60%, 
                    #7f8c8d 80%, 
                    #95a5a6 100%);
            border-radius: 2px;
            box-shadow: 
                inset 0 1px 2px rgba(255,255,255,0.6),
                inset 0 -1px 2px rgba(0,0,0,0.2);
        }

        .pencil-ferrule::before {
            content: '';
            position: absolute;
            left: 2px;
            top: 2px;
            right: 2px;
            bottom: 2px;
            background: linear-gradient(90deg, #ecf0f1 0%, #bdc3c7 100%);
            border-radius: 1px;
        }

        .pencil-eraser {
            position: absolute;
            right: 20px;
            top: 1px;
            width: 12px;
            height: 10px;
            background: 
                linear-gradient(180deg, 
                    #e74c3c 0%, 
                    #c0392b 50%, 
                    #a93226 100%);
            border-radius: 2px;
            box-shadow: 
                0 2px 4px rgba(0,0,0,0.3),
                inset 0 1px 2px rgba(255,255,255,0.3);
        }

        .pencil-grip {
            position: absolute;
            left: 40px;
            top: 2px;
            width: 60px;
            height: 8px;
            background: 
                repeating-linear-gradient(90deg,
                    transparent 0px,
                    transparent 3px,
                    rgba(0,0,0,0.1) 3px,
                    rgba(0,0,0,0.1) 4px
                );
            border-radius: 4px;
        }

        .container:hover {
            transform: scale(1.02);
            transition: transform 0.3s ease;
        }

        .pencil:hover {
            transform: rotate(-12deg) scale(1.05);
            transition: transform 0.3s ease;
        }

        canvas:hover {
            filter: brightness(1.02);
            transition: filter 0.3s ease;
        }

        @media (max-width: 480px) {
            .container {
                width: 320px;
                height: 568px;
                border-radius: 16px;
            }
            
            .paper {
                border-radius: 16px;
            }
            
            .paper::before,
            .paper::after {
                border-radius: 16px;
            }
            
            .book-spine {
                border-radius: 16px 0 0 16px;
            }
            
            canvas {
                border-radius: 16px;
            }
            
            .batman-text {
                font-size: 36px;
            }
            
            .pencil {
                width: 140px;
                height: 10px;
                top: 80px;
                right: -40px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="paper">
            <canvas id="drawingCanvas"></canvas>
            <div class="pencil" id="pencil"></div>
        </div>
    </div>

    <script>
const canvas = document.getElementById('drawingCanvas');
const ctx = canvas.getContext('2d');
const pencil = document.getElementById('pencil');

// Set 4K canvas size for ultra-crisp rendering
canvas.width = 1440;
canvas.height = 2560;
canvas.style.width = '360px';
canvas.style.height = '640px';

// Enable high-quality rendering
ctx.imageSmoothingEnabled = true;
ctx.imageSmoothingQuality = 'high';

let animationProgress = 0;
let drawnPoints = [];
let isAnimating = false;
let currentPhase = 0;

// More anatomically accurate Batman silhouette with proper proportions
const batmanOutline = [
    // Head outline (more angular and defined)
    {x: 720, y: 280}, {x: 700, y: 275}, {x: 680, y: 280}, {x: 665, y: 290},
    {x: 650, y: 305}, {x: 640, y: 325}, {x: 635, y: 350}, {x: 638, y: 375},
    {x: 645, y: 400}, {x: 655, y: 420}, {x: 670, y: 435}, {x: 690, y: 445},
    {x: 710, y: 450}, {x: 720, y: 452}, {x: 730, y: 450}, {x: 750, y: 445},
    {x: 770, y: 435}, {x: 785, y: 420}, {x: 795, y: 400}, {x: 802, y: 375},
    {x: 805, y: 350}, {x: 800, y: 325}, {x: 790, y: 305}, {x: 775, y: 290},
    {x: 760, y: 280}, {x: 740, y: 275},
    
    // Left ear (more bat-like, pointed)
    {x: 680, y: 280}, {x: 655, y: 240}, {x: 645, y: 200}, {x: 635, y: 180},
    {x: 650, y: 190}, {x: 665, y: 210}, {x: 675, y: 235}, {x: 678, y: 265},
    
    // Right ear (symmetric)
    {x: 760, y: 280}, {x: 785, y: 240}, {x: 795, y: 200}, {x: 805, y: 180},
    {x: 790, y: 190}, {x: 775, y: 210}, {x: 765, y: 235}, {x: 762, y: 265},
    
    // Jawline and chin definition
    {x: 690, y: 445}, {x: 700, y: 460}, {x: 715, y: 468}, {x: 720, y: 470},
    {x: 725, y: 468}, {x: 740, y: 460}, {x: 750, y: 445},
    
    // Neck (muscular and defined)
    {x: 690, y: 460}, {x: 685, y: 480}, {x: 680, y: 500}, {x: 675, y: 520},
    {x: 750, y: 460}, {x: 755, y: 480}, {x: 760, y: 500}, {x: 765, y: 520},
    
    // Shoulders (broader, more heroic)
    {x: 675, y: 520}, {x: 650, y: 540}, {x: 620, y: 565}, {x: 590, y: 595},
    {x: 765, y: 520}, {x: 790, y: 540}, {x: 820, y: 565}, {x: 850, y: 595},
    
    // Left cape dramatic flow
    {x: 590, y: 595}, {x: 540, y: 640}, {x: 500, y: 700}, {x: 470, y: 770},
    {x: 450, y: 850}, {x: 440, y: 940}, {x: 445, y: 1030}, {x: 460, y: 1120},
    {x: 485, y: 1200}, {x: 520, y: 1270}, {x: 565, y: 1330}, {x: 620, y: 1380},
    {x: 680, y: 1420}, {x: 720, y: 1440},
    
    // Right cape dramatic flow
    {x: 850, y: 595}, {x: 900, y: 640}, {x: 940, y: 700}, {x: 970, y: 770},
    {x: 990, y: 850}, {x: 1000, y: 940}, {x: 995, y: 1030}, {x: 980, y: 1120},
    {x: 955, y: 1200}, {x: 920, y: 1270}, {x: 875, y: 1330}, {x: 820, y: 1380},
    {x: 760, y: 1420}, {x: 720, y: 1440},
    
    // Torso (V-shaped, athletic build)
    {x: 650, y: 540}, {x: 635, y: 580}, {x: 625, y: 620}, {x: 620, y: 660},
    {x: 625, y: 700}, {x: 640, y: 740}, {x: 665, y: 780}, {x: 695, y: 810},
    {x: 715, y: 825}, {x: 720, y: 830}, {x: 725, y: 825}, {x: 745, y: 810},
    {x: 775, y: 780}, {x: 800, y: 740}, {x: 815, y: 700}, {x: 820, y: 660},
    {x: 815, y: 620}, {x: 805, y: 580}, {x: 790, y: 540},
    
    // Arms (more muscular definition)
    {x: 620, y: 580}, {x: 575, y: 605}, {x: 540, y: 640}, {x: 520, y: 680},
    {x: 515, y: 720}, {x: 525, y: 760}, {x: 545, y: 785},
    {x: 820, y: 580}, {x: 865, y: 605}, {x: 900, y: 640}, {x: 920, y: 680},
    {x: 925, y: 720}, {x: 915, y: 760}, {x: 895, y: 785},
    
    // Enhanced bat symbol (more detailed wing structure)
    {x: 720, y: 720}, {x: 695, y: 735}, {x: 675, y: 745}, {x: 655, y: 760},
    {x: 640, y: 775}, {x: 650, y: 785}, {x: 670, y: 790}, {x: 690, y: 785},
    {x: 705, y: 775}, {x: 720, y: 785}, {x: 735, y: 775}, {x: 750, y: 785},
    {x: 770, y: 790}, {x: 790, y: 785}, {x: 800, y: 775}, {x: 785, y: 760},
    {x: 765, y: 745}, {x: 745, y: 735}
];

// Detailed facial features for realism
const faceDetails = {
    leftEye: [
        {x: 670, y: 375}, {x: 665, y: 385}, {x: 670, y: 395}, {x: 680, y: 400},
        {x: 690, y: 395}, {x: 695, y: 385}, {x: 690, y: 375}, {x: 680, y: 370}
    ],
    rightEye: [
        {x: 750, y: 375}, {x: 745, y: 385}, {x: 750, y: 395}, {x: 760, y: 400},
        {x: 770, y: 395}, {x: 775, y: 385}, {x: 770, y: 375}, {x: 760, y: 370}
    ],
    nose: [
        {x: 720, y: 395}, {x: 715, y: 405}, {x: 710, y: 415}, {x: 715, y: 420},
        {x: 720, y: 418}, {x: 725, y: 420}, {x: 730, y: 415}, {x: 725, y: 405}
    ],
    mouth: [
        {x: 705, y: 430}, {x: 715, y: 435}, {x: 720, y: 438}, {x: 725, y: 435}, {x: 735, y: 430}
    ],
    jawMuscles: [
        {x: 660, y: 420}, {x: 670, y: 430}, {x: 680, y: 435},
        {x: 760, y: 435}, {x: 770, y: 430}, {x: 780, y: 420}
    ]
};

// Enhanced body muscle definition
const muscleDefinition = [
    // Chest muscles
    {x: 670, y: 600}, {x: 680, y: 620}, {x: 695, y: 640}, {x: 720, y: 650},
    {x: 745, y: 640}, {x: 760, y: 620}, {x: 770, y: 600},
    // Ab definition
    {x: 700, y: 720}, {x: 720, y: 730}, {x: 740, y: 720},
    {x: 705, y: 750}, {x: 720, y: 760}, {x: 735, y: 750},
    {x: 710, y: 780}, {x: 720, y: 790}, {x: 730, y: 780}
];

function drawPencilPhase(progress) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Enhanced pencil stroke style
    ctx.strokeStyle = '#4a4a4a';
    ctx.lineWidth = 2.5;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    ctx.shadowColor = 'rgba(0,0,0,0.15)';
    ctx.shadowBlur = 1;
    ctx.shadowOffsetX = 0.5;
    ctx.shadowOffsetY = 0.5;
    
    const totalPoints = Math.floor(progress * batmanOutline.length);
    
    if (totalPoints > drawnPoints.length) {
        for (let i = drawnPoints.length; i < totalPoints && i < batmanOutline.length; i++) {
            drawnPoints.push(batmanOutline[i]);
        }
    }
    
    if (drawnPoints.length > 1) {
        ctx.beginPath();
        ctx.moveTo(drawnPoints[0].x, drawnPoints[0].y);
        
        for (let i = 1; i < drawnPoints.length; i++) {
            // Subtle pencil texture with controlled variation
            const jitterX = (Math.random() - 0.5) * 1.5;
            const jitterY = (Math.random() - 0.5) * 1.5;
            ctx.lineTo(drawnPoints[i].x + jitterX, drawnPoints[i].y + jitterY);
        }
        ctx.stroke();
    }
    
    // Enhanced pencil positioning
    if (pencil && drawnPoints.length > 0) {
        const lastPoint = drawnPoints[drawnPoints.length - 1];
        pencil.style.left = (lastPoint.x / 4 - 12) + 'px';
        pencil.style.top = (lastPoint.y / 4 - 8) + 'px';
        pencil.style.opacity = '0.9';
        
        if (drawnPoints.length > 1) {
            const prevPoint = drawnPoints[drawnPoints.length - 2];
            const angle = Math.atan2(lastPoint.y - prevPoint.y, lastPoint.x - prevPoint.x);
            pencil.style.transform = `rotate(${angle + Math.PI/4}rad) scale(1.1)`;
        }
    }
}

function drawInkPhase() {
    if (pencil) pencil.style.opacity = '0';
    
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.shadowColor = 'transparent';
    
    // Main outline with varying line weights
    ctx.strokeStyle = '#000';
    ctx.lineWidth = 3.5;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    
    ctx.beginPath();
    ctx.moveTo(batmanOutline[0].x, batmanOutline[0].y);
    for (let i = 1; i < batmanOutline.length; i++) {
        // Vary line weight for depth
        const weight = i % 10 === 0 ? 4.5 : 3.5;
        ctx.lineWidth = weight;
        ctx.lineTo(batmanOutline[i].x, batmanOutline[i].y);
    }
    ctx.stroke();
    
    // Draw detailed facial features
    ctx.lineWidth = 2;
    
    // Eyes with more detail
    ctx.strokeStyle = '#000';
    ctx.beginPath();
    ctx.moveTo(faceDetails.leftEye[0].x, faceDetails.leftEye[0].y);
    for (let i = 1; i < faceDetails.leftEye.length; i++) {
        ctx.lineTo(faceDetails.leftEye[i].x, faceDetails.leftEye[i].y);
    }
    ctx.closePath();
    ctx.stroke();
    
    ctx.beginPath();
    ctx.moveTo(faceDetails.rightEye[0].x, faceDetails.rightEye[0].y);
    for (let i = 1; i < faceDetails.rightEye.length; i++) {
        ctx.lineTo(faceDetails.rightEye[i].x, faceDetails.rightEye[i].y);
    }
    ctx.closePath();
    ctx.stroke();
    
    // Nose detail
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(faceDetails.nose[0].x, faceDetails.nose[0].y);
    for (let i = 1; i < faceDetails.nose.length; i++) {
        ctx.lineTo(faceDetails.nose[i].x, faceDetails.nose[i].y);
    }
    ctx.stroke();
    
    // Mouth
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(faceDetails.mouth[0].x, faceDetails.mouth[0].y);
    for (let i = 1; i < faceDetails.mouth.length; i++) {
        ctx.lineTo(faceDetails.mouth[i].x, faceDetails.mouth[i].y);
    }
    ctx.stroke();
    
    // Jaw muscle definition
    ctx.lineWidth = 1;
    for (let i = 0; i < faceDetails.jawMuscles.length - 1; i++) {
        ctx.beginPath();
        ctx.moveTo(faceDetails.jawMuscles[i].x, faceDetails.jawMuscles[i].y);
        ctx.lineTo(faceDetails.jawMuscles[i + 1].x, faceDetails.jawMuscles[i + 1].y);
        ctx.stroke();
    }
    
    // Muscle definition lines
    ctx.lineWidth = 1.5;
    for (let i = 0; i < muscleDefinition.length - 1; i++) {
        ctx.beginPath();
        ctx.moveTo(muscleDefinition[i].x, muscleDefinition[i].y);
        ctx.lineTo(muscleDefinition[i + 1].x, muscleDefinition[i + 1].y);
        ctx.stroke();
    }
}

function drawColorPhase() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // More realistic cape with complex gradient
    const capeGradient = ctx.createLinearGradient(450, 600, 990, 1400);
    capeGradient.addColorStop(0, '#0d1421');
    capeGradient.addColorStop(0.2, '#1a1a2e');
    capeGradient.addColorStop(0.4, '#16213e');
    capeGradient.addColorStop(0.6, '#0f1419');
    capeGradient.addColorStop(0.8, '#1a252f');
    capeGradient.addColorStop(1, '#0a0e1a');
    
    ctx.fillStyle = capeGradient;
    ctx.beginPath();
    ctx.moveTo(590, 595);
    ctx.lineTo(540, 640);
    ctx.lineTo(500, 700);
    ctx.lineTo(470, 770);
    ctx.lineTo(450, 850);
    ctx.lineTo(440, 940);
    ctx.lineTo(445, 1030);
    ctx.lineTo(460, 1120);
    ctx.lineTo(485, 1200);
    ctx.lineTo(520, 1270);
    ctx.lineTo(565, 1330);
    ctx.lineTo(620, 1380);
    ctx.lineTo(680, 1420);
    ctx.lineTo(720, 1440);
    ctx.lineTo(760, 1420);
    ctx.lineTo(820, 1380);
    ctx.lineTo(875, 1330);
    ctx.lineTo(920, 1270);
    ctx.lineTo(955, 1200);
    ctx.lineTo(980, 1120);
    ctx.lineTo(995, 1030);
    ctx.lineTo(1000, 940);
    ctx.lineTo(990, 850);
    ctx.lineTo(970, 770);
    ctx.lineTo(940, 700);
    ctx.lineTo(900, 640);
    ctx.lineTo(850, 595);
    ctx.closePath();
    ctx.fill();
    
    // Body suit with realistic muscle shading
    const suitGradient = ctx.createRadialGradient(720, 680, 0, 720, 680, 180);
    suitGradient.addColorStop(0, '#4a5568');
    suitGradient.addColorStop(0.3, '#2d3748');
    suitGradient.addColorStop(0.7, '#1a202c');
    suitGradient.addColorStop(1, '#171923');
    
    ctx.fillStyle = suitGradient;
    ctx.beginPath();
    ctx.moveTo(650, 540);
    ctx.lineTo(635, 580);
    ctx.lineTo(625, 620);
    ctx.lineTo(620, 660);
    ctx.lineTo(625, 700);
    ctx.lineTo(640, 740);
    ctx.lineTo(665, 780);
    ctx.lineTo(695, 810);
    ctx.lineTo(715, 825);
    ctx.lineTo(720, 830);
    ctx.lineTo(725, 825);
    ctx.lineTo(745, 810);
    ctx.lineTo(775, 780);
    ctx.lineTo(800, 740);
    ctx.lineTo(815, 700);
    ctx.lineTo(820, 660);
    ctx.lineTo(815, 620);
    ctx.lineTo(805, 580);
    ctx.lineTo(790, 540);
    ctx.closePath();
    ctx.fill();
    
    // Cowl (matte black with subtle highlights)
    const cowlGradient = ctx.createRadialGradient(720, 350, 0, 720, 350, 120);
    cowlGradient.addColorStop(0, '#2d2d2d');
    cowlGradient.addColorStop(0.6, '#1a1a1a');
    cowlGradient.addColorStop(1, '#000000');
    
    ctx.fillStyle = cowlGradient;
    ctx.beginPath();
    ctx.moveTo(720, 280);
    ctx.lineTo(700, 275);
    ctx.lineTo(680, 280);
    ctx.lineTo(665, 290);
    ctx.lineTo(650, 305);
    ctx.lineTo(640, 325);
    ctx.lineTo(635, 350);
    ctx.lineTo(638, 375);
    ctx.lineTo(645, 400);
    ctx.lineTo(655, 420);
    ctx.lineTo(670, 435);
    ctx.lineTo(690, 445);
    ctx.lineTo(710, 450);
    ctx.lineTo(720, 452);
    ctx.lineTo(730, 450);
    ctx.lineTo(750, 445);
    ctx.lineTo(770, 435);
    ctx.lineTo(785, 420);
    ctx.lineTo(795, 400);
    ctx.lineTo(802, 375);
    ctx.lineTo(805, 350);
    ctx.lineTo(800, 325);
    ctx.lineTo(790, 305);
    ctx.lineTo(775, 290);
    ctx.lineTo(760, 280);
    ctx.lineTo(740, 275);
    ctx.closePath();
    ctx.fill();
    
    // Enhanced bat ears
    ctx.fillStyle = '#000';
    ctx.beginPath();
    ctx.moveTo(680, 280);
    ctx.lineTo(655, 240);
    ctx.lineTo(645, 200);
    ctx.lineTo(635, 180);
    ctx.lineTo(650, 190);
    ctx.lineTo(665, 210);
    ctx.lineTo(675, 235);
    ctx.lineTo(678, 265);
    ctx.closePath();
    ctx.fill();
    
    ctx.beginPath();
    ctx.moveTo(760, 280);
    ctx.lineTo(785, 240);
    ctx.lineTo(795, 200);
    ctx.lineTo(805, 180);
    ctx.lineTo(790, 190);
    ctx.lineTo(775, 210);
    ctx.lineTo(765, 235);
    ctx.lineTo(762, 265);
    ctx.closePath();
    ctx.fill();
    
    // Enhanced bat symbol with metallic effect
    const batSymbolGradient = ctx.createRadialGradient(720, 750, 0, 720, 750, 80);
    batSymbolGradient.addColorStop(0, '#ffdf00');
    batSymbolGradient.addColorStop(0.3, '#ffd700');
    batSymbolGradient.addColorStop(0.6, '#ffb700');
    batSymbolGradient.addColorStop(0.8, '#e6a800');
    batSymbolGradient.addColorStop(1, '#cc9900');
    
    ctx.fillStyle = batSymbolGradient;
    ctx.beginPath();
    ctx.moveTo(720, 720);
    ctx.lineTo(695, 735);
    ctx.lineTo(675, 745);
    ctx.lineTo(655, 760);
    ctx.lineTo(640, 775);
    ctx.lineTo(650, 785);
    ctx.lineTo(670, 790);
    ctx.lineTo(690, 785);
    ctx.lineTo(705, 775);
    ctx.lineTo(720, 785);
    ctx.lineTo(735, 775);
    ctx.lineTo(750, 785);
    ctx.lineTo(770, 790);
    ctx.lineTo(790, 785);
    ctx.lineTo(800, 775);
    ctx.lineTo(785, 760);
    ctx.lineTo(765, 745);
    ctx.lineTo(745, 735);
    ctx.closePath();
    ctx.fill();
    
    // Realistic utility belt with texture
    const beltGradient = ctx.createLinearGradient(600, 830, 840, 855);
    beltGradient.addColorStop(0, '#8b4513');
    beltGradient.addColorStop(0.5, '#a0522d');
    beltGradient.addColorStop(1, '#654321');
    
    ctx.fillStyle = beltGradient;
    ctx.fillRect(600, 830, 240, 25);
    
    // Belt accessories and buckle
    ctx.fillStyle = '#daa520';
    ctx.fillRect(705, 835, 30, 15);
    ctx.fillStyle = '#b8860b';
    ctx.fillRect(620, 837, 15, 11);
    ctx.fillRect(805, 837, 15, 11);
    ctx.fillRect(680, 837, 12, 11);
    ctx.fillRect(748, 837, 12, 11);
    
    // Advanced muscle definition with proper highlights and shadows
    ctx.fillStyle = 'rgba(255,255,255,0.12)';
    // Chest highlights
    ctx.beginPath();
    ctx.ellipse(680, 650, 25, 40, -0.2, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.beginPath();
    ctx.ellipse(760, 650, 25, 40, 0.2, 0, Math.PI * 2);
    ctx.fill();
    
    // Ab definition
    ctx.beginPath();
    ctx.ellipse(720, 720, 15, 20, 0, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.beginPath();
    ctx.ellipse(720, 760, 12, 18, 0, 0, Math.PI * 2);
    ctx.fill();
    
    // Shoulder muscle highlights
    ctx.beginPath();
    ctx.ellipse(650, 560, 20, 30, -0.5, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.beginPath();
    ctx.ellipse(790, 560, 20, 30, 0.5, 0, Math.PI * 2);
    ctx.fill();
    
    // Face skin tone and highlights
    ctx.fillStyle = 'rgba(255,255,255,0.08)';
    ctx.beginPath();
    ctx.ellipse(700, 360, 18, 30, -0.15, 0, Math.PI * 2);
    ctx.fill();
    
    // Enhanced eyes with realistic detail
    ctx.fillStyle = '#ffffff';
    ctx.beginPath();
    ctx.ellipse(680, 385, 12, 16, -0.1, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.beginPath();
    ctx.ellipse(760, 385, 12, 16, 0.1, 0, Math.PI * 2);
    ctx.fill();
    
    // Eye pupils with intensity
    ctx.fillStyle = '#000000';
    ctx.beginPath();
    ctx.ellipse(680, 390, 5, 8, 0, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.beginPath();
    ctx.ellipse(760, 390, 5, 8, 0, 0, Math.PI * 2);
    ctx.fill();
    
    // Eye reflections for life-like appearance
    ctx.fillStyle = 'rgba(255,255,255,0.6)';
    ctx.beginPath();
    ctx.ellipse(683, 387, 2, 3, 0, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.beginPath();
    ctx.ellipse(763, 387, 2, 3, 0, 0, Math.PI * 2);
    ctx.fill();
    
    // Enhanced final outline with varying weights
    ctx.strokeStyle = '#000000';
    ctx.lineWidth = 3;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    
    ctx.beginPath();
    ctx.moveTo(batmanOutline[0].x, batmanOutline[0].y);
    for (let i = 1; i < batmanOutline.length; i++) {
        ctx.lineTo(batmanOutline[i].x, batmanOutline[i].y);
    }
    ctx.stroke();
    
    // Cape flow lines for dramatic effect
    ctx.lineWidth = 1.5;
    ctx.strokeStyle = 'rgba(0,0,0,0.3)';
    ctx.beginPath();
    ctx.moveTo(550, 700);
    ctx.quadraticCurveTo(580, 900, 560, 1100);
    ctx.quadraticCurveTo(570, 1200, 600, 1300);
    ctx.stroke();
    
    ctx.beginPath();
    ctx.moveTo(890, 700);
    ctx.quadraticCurveTo(860, 900, 880, 1100);
    ctx.quadraticCurveTo(870, 1200, 840, 1300);
    ctx.stroke();
    
    // Additional cape detail
    ctx.strokeStyle = 'rgba(255,255,255,0.05)';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(580, 750);
    ctx.quadraticCurveTo(620, 950, 580, 1150);
    ctx.stroke();
    
    ctx.beginPath();
    ctx.moveTo(860, 750);
    ctx.quadraticCurveTo(820, 950, 860, 1150);
    ctx.stroke();
}

function animateBatman() {
    // Simple breathing animation
    const breatheScale = 1 + Math.sin(Date.now() * 0.003) * 0.008;
    const eyeGlow = 0.5 + Math.sin(Date.now() * 0.004) * 0.3;
    
    ctx.save();
    ctx.translate(720, 800);
    ctx.scale(breatheScale, breatheScale);
    ctx.translate(-720, -800);
    
    // Subtle eye glow effect
    ctx.fillStyle = `rgba(255,255,255,${eyeGlow * 0.2})`;
    ctx.beginPath();
    ctx.ellipse(680, 385, 15, 18, -0.1, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.beginPath();
    ctx.ellipse(760, 385, 15, 18, 0.1, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.restore();
    
    // Cape subtle movement
    const capeWave = Math.sin(Date.now() * 0.002) * 2;
    ctx.strokeStyle = `rgba(0,0,0,0.1)`;
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(550 + capeWave, 700);
    ctx.quadraticCurveTo(580, 900, 560 - capeWave, 1100);
    ctx.stroke();
    
    ctx.beginPath();
    ctx.moveTo(890 - capeWave, 700);
    ctx.quadraticCurveTo(860, 900, 880 + capeWave, 1100);
    ctx.stroke();
}

function animate() {
    const startTime = Date.now();
    
    function frame() {
        const elapsed = Date.now() - startTime;
        const totalDuration = 40000; // 40 seconds for more detailed drawing
        const progress = Math.min(elapsed / totalDuration, 1);
        
        // Phase 1: Detailed pencil sketch (0-50%)
        if (progress < 0.5) {
            const phaseProgress = progress / 0.5;
            drawPencilPhase(phaseProgress);
            currentPhase = 1;
        }
        // Phase 2: Professional inking (50-75%)
        else if (progress < 0.75) {
            if (currentPhase !== 2) {
                drawInkPhase();
                currentPhase = 2;
            }
        }
        // Phase 3: Realistic coloring (75-100%)
        else {
            if (currentPhase !== 3) {
                drawColorPhase();
                currentPhase = 3;
            }
            // Add Batman animation after coloring is complete
            if (progress > 0.85) {
                animateBatman();
            }
        }
        
        if (progress < 1) {
            requestAnimationFrame(frame);
        } else {
            // Continue Batman animation and restart after 6 seconds
            const animationFrame = () => {
                drawColorPhase();
                animateBatman();
                requestAnimationFrame(animationFrame);
            };
            animationFrame();
            
            setTimeout(() => {
                drawnPoints = [];
                currentPhase = 0;
                animate();
            }, 6000);
        }
    }
    
    requestAnimationFrame(frame);
}

// Enhanced initialization
function init() {
    if (canvas && ctx) {
        // Set initial canvas state
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Add loading effect
        ctx.fillStyle = 'rgba(0,0,0,0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        setTimeout(animate, 1500);
    }
}

// Smart initialization based on document state
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
} else {
    init();
}
    </script>
</body>
</html>
