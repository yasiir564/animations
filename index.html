<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Krusty Krab Drawing Animation</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #2c1810;
            font-family: 'Times New Roman', serif;
        }
        
        .container {
            width: 450px;
            height: 650px;
            background: linear-gradient(135deg, #f8f5f0 0%, #f2ede5 100%);
            border-radius: 8px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            overflow: hidden;
            position: relative;
            border: 3px solid #8b6f47;
        }
        
        .book-paper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                /* Vertical lines for notebook paper */
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 24px,
                    rgba(200, 180, 150, 0.3) 24px,
                    rgba(200, 180, 150, 0.3) 25px
                ),
                /* Horizontal lines */
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 19px,
                    rgba(180, 160, 140, 0.2) 19px,
                    rgba(180, 160, 140, 0.2) 20px
                ),
                /* Red margin line */
                linear-gradient(
                    90deg,
                    transparent 45px,
                    #ff6b6b 45px,
                    #ff6b6b 47px,
                    transparent 47px
                ),
                /* Paper texture */
                radial-gradient(circle at 20% 30%, rgba(139, 111, 71, 0.03) 1px, transparent 1px),
                radial-gradient(circle at 80% 70%, rgba(139, 111, 71, 0.03) 1px, transparent 1px),
                radial-gradient(circle at 40% 80%, rgba(139, 111, 71, 0.025) 1px, transparent 1px),
                /* Base paper color */
                #f8f5f0;
            background-size: 
                100% 100%,
                100% 100%,
                100% 100%,
                50px 50px,
                30px 30px,
                70px 70px,
                100% 100%;
        }
        
        /* Spiral binding holes */
        .binding-holes {
            position: absolute;
            left: 20px;
            top: 30px;
            height: calc(100% - 60px);
            width: 10px;
        }
        
        .hole {
            width: 8px;
            height: 8px;
            background: #2c1810;
            border-radius: 50%;
            margin-bottom: 40px;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.3);
        }
        
        canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        .pencil {
            position: absolute;
            width: 90px;
            height: 8px;
            background: linear-gradient(90deg, #8B4513 0%, #DEB887 30%, #FFD700 60%, #FF69B4 100%);
            border-radius: 4px;
            z-index: 10;
            opacity: 0;
            transform-origin: left center;
            transition: opacity 0.5s ease;
        }
        
        .pencil::before {
            content: '';
            position: absolute;
            left: -12px;
            top: 1px;
            width: 0;
            height: 0;
            border-left: 12px solid #2F4F4F;
            border-top: 3px solid transparent;
            border-bottom: 3px solid transparent;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="book-paper"></div>
        <div class="binding-holes">
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
        </div>
        <canvas id="drawingCanvas" width="450" height="650"></canvas>
        <div class="pencil" id="pencil"></div>
    </div>

    <script>
        const canvas = document.getElementById('drawingCanvas');
        const ctx = canvas.getContext('2d');
        const pencil = document.getElementById('pencil');
        
        // Animation state
        let animationProgress = 0;
        const totalDuration = 30000; // 30 seconds
        let startTime = null;
        
        // Drawing phases
        const phases = {
            sketch: { start: 0, end: 0.3 },
            detail: { start: 0.3, end: 0.5 },
            ink: { start: 0.5, end: 0.7 },
            color: { start: 0.7, end: 1.0 }
        };
        
        // Krusty Krab structure points (matching the reference image)
        const structure = {
            // Main building base (wooden logs structure)
            base: [
                {x: 120, y: 450}, {x: 330, y: 450}, {x: 330, y: 380}, {x: 120, y: 380}
            ],
            // Lobster claw/wooden roof structure
            roof: [
                {x: 100, y: 380}, {x: 130, y: 320}, {x: 170, y: 300}, {x: 225, y: 300},
                {x: 280, y: 320}, {x: 320, y: 340}, {x: 350, y: 380}
            ],
            // Sign post
            signPost: [
                {x: 80, y: 320}, {x: 80, y: 500}
            ],
            // Clamshell sign
            sign: [
                {x: 50, y: 260}, {x: 110, y: 260}, {x: 115, y: 280}, {x: 110, y: 320}, 
                {x: 50, y: 320}, {x: 45, y: 280}
            ],
            // Left window
            leftWindow: [
                {x: 140, y: 400}, {x: 180, y: 400}, {x: 180, y: 430}, {x: 140, y: 430}
            ],
            // Right window  
            rightWindow: [
                {x: 270, y: 400}, {x: 310, y: 400}, {x: 310, y: 430}, {x: 270, y: 430}
            ],
            // Door
            door: [
                {x: 200, y: 410}, {x: 250, y: 410}, {x: 250, y: 450}, {x: 200, y: 450}
            ],
            // Chimney
            chimney: [
                {x: 285, y: 300}, {x: 305, y: 300}, {x: 305, y: 260}, {x: 285, y: 260}
            ],
            // Flag bunting
            bunting: [
                {x: 130, y: 360}, {x: 150, y: 350}, {x: 170, y: 360}, {x: 190, y: 350},
                {x: 210, y: 360}, {x: 230, y: 350}, {x: 250, y: 360}, {x: 270, y: 350},
                {x: 290, y: 360}, {x: 310, y: 350}, {x: 330, y: 360}
            ]
        };
        
        function getCurrentPhase(progress) {
            if (progress <= phases.sketch.end) return 'sketch';
            if (progress <= phases.detail.end) return 'detail';
            if (progress <= phases.ink.end) return 'ink';
            return 'color';
        }
        
        function getPhaseProgress(progress, phase) {
            const p = phases[phase];
            return Math.max(0, Math.min(1, (progress - p.start) / (p.end - p.start)));
        }
        
        function drawPath(points, progress, style = {}) {
            if (points.length === 0) return;
            
            ctx.beginPath();
            ctx.moveTo(points[0].x, points[0].y);
            
            const totalPoints = points.length;
            const pointsToShow = Math.floor(totalPoints * progress);
            
            for (let i = 1; i < pointsToShow; i++) {
                ctx.lineTo(points[i].x, points[i].y);
            }
            
            // Partial line for smooth animation
            if (pointsToShow < totalPoints && pointsToShow > 0) {
                const prev = points[pointsToShow - 1];
                const next = points[pointsToShow];
                const partialProgress = (totalPoints * progress) - (pointsToShow - 1);
                const x = prev.x + (next.x - prev.x) * partialProgress;
                const y = prev.y + (next.y - prev.y) * partialProgress;
                ctx.lineTo(x, y);
                
                // Update pencil position
                pencil.style.left = (x - 45) + 'px';
                pencil.style.top = (y - 4) + 'px';
                pencil.style.transform = `rotate(${Math.atan2(next.y - prev.y, next.x - prev.x)}rad)`;
            }
            
            // Apply styles
            ctx.strokeStyle = style.color || '#333';
            ctx.lineWidth = style.width || 2;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            if (style.fill) {
                ctx.fillStyle = style.fill;
                ctx.fill();
            }
            ctx.stroke();
        }
        
        function drawBackground(progress) {
            // Ocean background (blue)
            const colorProgress = getPhaseProgress(progress, 'color');
            if (colorProgress > 0) {
                const alpha = colorProgress * 0.9;
                // Sky blue background
                ctx.fillStyle = `rgba(52, 152, 219, ${alpha})`;
                ctx.fillRect(60, 50, 370, 300);
                
                // Ground (sand)
                ctx.fillStyle = `rgba(244, 208, 63, ${alpha})`;
                ctx.fillRect(60, 470, 370, 100);
                
                // Add some underwater elements
                // Jellyfish
                for (let i = 0; i < 3; i++) {
                    const x = 80 + i * 120;
                    const y = 80 + Math.sin(Date.now() * 0.001 + i) * 10;
                    
                    // Jellyfish body
                    ctx.beginPath();
                    ctx.arc(x, y, 15, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(147, 196, 255, ${alpha * 0.7})`;
                    ctx.fill();
                    
                    // Jellyfish tentacles
                    ctx.strokeStyle = `rgba(147, 196, 255, ${alpha * 0.7})`;
                    ctx.lineWidth = 2;
                    for (let j = 0; j < 4; j++) {
                        ctx.beginPath();
                        ctx.moveTo(x - 10 + j * 7, y + 15);
                        ctx.lineTo(x - 10 + j * 7, y + 35 + Math.sin(Date.now() * 0.002 + j) * 5);
                        ctx.stroke();
                    }
                }
                
                // Bubbles
                for (let i = 0; i < 8; i++) {
                    ctx.beginPath();
                    ctx.arc(
                        100 + i * 40, 
                        150 + Math.sin(Date.now() * 0.001 + i) * 30, 
                        2 + Math.sin(Date.now() * 0.002 + i) * 1, 
                        0, Math.PI * 2
                    );
                    ctx.fillStyle = `rgba(200, 230, 255, ${alpha * 0.6})`;
                    ctx.fill();
                }
            }
        }
        
        function drawKrustyKrab(progress) {
            const currentPhase = getCurrentPhase(progress);
            const phaseProgress = getPhaseProgress(progress, currentPhase);
            
            let strokeStyle = {
                color: '#666',
                width: 1
            };
            
            switch (currentPhase) {
                case 'sketch':
                    strokeStyle = { color: '#999', width: 1 };
                    pencil.style.opacity = '1';
                    break;
                case 'detail':
                    strokeStyle = { color: '#555', width: 1.5 };
                    break;
                case 'ink':
                    strokeStyle = { color: '#222', width: 2 };
                    pencil.style.opacity = '0.5';
                    break;
                case 'color':
                    strokeStyle = { color: '#000', width: 2 };
                    pencil.style.opacity = '0';
                    break;
            }
            
            // Draw colored elements first (when in color phase)
            if (currentPhase === 'color') {
                const colorAlpha = getPhaseProgress(progress, 'color');
                
                // Main building (brown wood)
                ctx.fillStyle = `rgba(139, 111, 71, ${colorAlpha})`;
                ctx.fillRect(120, 380, 210, 70);
                
                // Wood log texture
                for (let i = 0; i < 5; i++) {
                    ctx.fillStyle = `rgba(101, 83, 51, ${colorAlpha * 0.8})`;
                    ctx.fillRect(120, 380 + i * 14, 210, 2);
                }
                
                // Roof (darker brown)
                ctx.fillStyle = `rgba(101, 67, 33, ${colorAlpha})`;
                ctx.beginPath();
                ctx.moveTo(100, 380);
                structure.roof.forEach(point => ctx.lineTo(point.x, point.y));
                ctx.lineTo(350, 380);
                ctx.closePath();
                ctx.fill();
                
                // Windows (light blue)
                ctx.fillStyle = `rgba(135, 206, 235, ${colorAlpha})`;
                ctx.fillRect(140, 400, 40, 30);
                ctx.fillRect(270, 400, 40, 30);
                
                // Window reflections
                ctx.fillStyle = `rgba(255, 255, 255, ${colorAlpha * 0.4})`;
                ctx.fillRect(145, 405, 15, 10);
                ctx.fillRect(275, 405, 15, 10);
                
                // Door (dark brown)
                ctx.fillStyle = `rgba(101, 67, 33, ${colorAlpha})`;
                ctx.fillRect(200, 410, 50, 40);
                
                // Door handle
                ctx.fillStyle = `rgba(255, 215, 0, ${colorAlpha})`;
                ctx.beginPath();
                ctx.arc(240, 430, 3, 0, Math.PI * 2);
                ctx.fill();
                
                // Chimney (gray)
                ctx.fillStyle = `rgba(128, 128, 128, ${colorAlpha})`;
                ctx.fillRect(285, 260, 20, 40);
                
                // Smoke
                ctx.fillStyle = `rgba(200, 200, 200, ${colorAlpha * 0.6})`;
                for (let i = 0; i < 3; i++) {
                    ctx.beginPath();
                    ctx.arc(295 + Math.sin(Date.now() * 0.001 + i) * 5, 240 - i * 15, 4 + i, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // Clamshell sign (white/pink)
                ctx.fillStyle = `rgba(255, 240, 245, ${colorAlpha})`;
                ctx.beginPath();
                structure.sign.forEach((point, i) => {
                    if (i === 0) ctx.moveTo(point.x, point.y);
                    else ctx.lineTo(point.x, point.y);
                });
                ctx.closePath();
                ctx.fill();
                
                // Sign text
                ctx.fillStyle = `rgba(139, 0, 0, ${colorAlpha})`;
                ctx.font = 'bold 12px serif';
                ctx.textAlign = 'center';
                ctx.fillText('THE', 80, 275);
                ctx.font = 'bold 10px serif';
                ctx.fillText('KRUSTY', 80, 290);
                ctx.fillText('KRAB', 80, 305);
                
                // Sign post (brown)
                ctx.strokeStyle = `rgba(139, 111, 71, ${colorAlpha})`;
                ctx.lineWidth = 6;
                ctx.beginPath();
                ctx.moveTo(80, 320);
                ctx.lineTo(80, 500);
                ctx.stroke();
                
                // Flag bunting (colorful)
                const flagColors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD'];
                for (let i = 0; i < flagColors.length && i * 2 < structure.bunting.length; i++) {
                    const x1 = structure.bunting[i * 2].x;
                    const y1 = structure.bunting[i * 2].y;
                    const x2 = structure.bunting[i * 2 + 1] ? structure.bunting[i * 2 + 1].x : x1;
                    const y2 = structure.bunting[i * 2 + 1] ? structure.bunting[i * 2 + 1].y : y1 - 10;
                    
                    ctx.fillStyle = flagColors[i % flagColors.length];
                    ctx.beginPath();
                    ctx.moveTo(x1, y1);
                    ctx.lineTo(x1 + 15, y1);
                    ctx.lineTo(x1 + 7, y1 + 12);
                    ctx.closePath();
                    ctx.fill();
                }
                
                // Bunting string
                ctx.strokeStyle = `rgba(0, 0, 0, ${colorAlpha})`;
                ctx.lineWidth = 1;
                drawPath(structure.bunting, 1, {color: `rgba(0, 0, 0, ${colorAlpha})`, width: 1});
            }
            
            // Draw outlines
            drawPath(structure.base, phaseProgress, strokeStyle);
            drawPath(structure.roof, phaseProgress, strokeStyle);
            drawPath(structure.signPost, phaseProgress, strokeStyle);
            drawPath(structure.sign, phaseProgress, strokeStyle);
            drawPath(structure.leftWindow, phaseProgress, strokeStyle);
            drawPath(structure.rightWindow, phaseProgress, strokeStyle);
            drawPath(structure.door, phaseProgress, strokeStyle);
            drawPath(structure.chimney, phaseProgress, strokeStyle);
            drawPath(structure.bunting, phaseProgress, strokeStyle);
        }
        
        function animate(timestamp) {
            if (!startTime) startTime = timestamp;
            const elapsed = timestamp - startTime;
            animationProgress = Math.min(elapsed / totalDuration, 1);
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background
            drawBackground(animationProgress);
            
            // Draw Krusty Krab
            drawKrustyKrab(animationProgress);
            
            // Continue animation
            if (animationProgress < 1) {
                requestAnimationFrame(animate);
            } else {
                // Animation complete, restart after 3 seconds
                setTimeout(() => {
                    startTime = null;
                    animationProgress = 0;
                    requestAnimationFrame(animate);
                }, 3000);
            }
        }
        
        // Start animation
        requestAnimationFrame(animate);
    </script>
</body>
</html>
