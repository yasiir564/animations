<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Football Player Matching Game</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .game-container {
            width: 400px;
            height: 720px;
            background: linear-gradient(180deg, #87CEEB 0%, #98FB98 25%, #32CD32 50%, #228B22 75%, #006400 100%);
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            border: 3px solid #fff;
        }

        /* Enhanced stadium background */
        .stadium-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at center bottom, rgba(255,255,255,0.1) 0%, transparent 70%),
                linear-gradient(90deg, 
                    rgba(255,255,255,0.05) 0%, 
                    transparent 10%, 
                    transparent 90%, 
                    rgba(255,255,255,0.05) 100%
                );
        }

        .field-lines {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 48%, rgba(255,255,255,0.3) 49%, rgba(255,255,255,0.3) 51%, transparent 52%),
                linear-gradient(0deg, transparent 48%, rgba(255,255,255,0.2) 49%, rgba(255,255,255,0.2) 51%, transparent 52%),
                radial-gradient(circle at 50% 50%, rgba(255,255,255,0.2) 68px, transparent 70px);
            background-size: 100% 100%, 100% 100%, 200px 200px;
            background-position: center, center, center;
        }

        .crowd-effect {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(180deg, rgba(0,0,0,0.3) 0%, transparent 100%);
            border-radius: 20px 20px 0 0;
        }

        .faces-section {
            position: absolute;
            top: 80px;
            left: 0;
            right: 0;
            height: 200px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0 20px;
            z-index: 10;
        }

        .player-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
        }

        .face-img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 4px solid #fff;
            box-shadow: 0 8px 25px rgba(0,0,0,0.4);
            object-fit: cover;
            background: #f0f0f0;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            position: relative;
            z-index: 15;
        }

        .face-img:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 30px rgba(0,0,0,0.5);
        }

        .face-img.selected {
            animation: playerPulse 0.8s ease-in-out;
            transform: scale(1.15);
        }

        .face-img.correct-match {
            animation: successGlow 1.2s ease-in-out;
        }

        .face-img.wrong-match {
            animation: errorShake 0.6s ease-in-out;
        }

        .player-name {
            font-size: 16px;
            font-weight: 800;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: rgba(0,0,0,0.4);
            padding: 6px 12px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .bodies-section {
            position: absolute;
            top: 320px;
            left: 0;
            right: 0;
            height: 320px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0 20px;
            z-index: 5;
        }

        .body-slot {
            width: 90px;
            height: 140px;
            position: relative;
            border: 3px dashed rgba(255,255,255,0.6);
            border-radius: 15px;
            overflow: hidden;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            transition: all 0.4s ease;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .body-slot:hover {
            border-color: rgba(255,255,255,0.9);
            background: rgba(255,255,255,0.2);
        }

        .body-slot.matched {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.2);
            box-shadow: 0 0 25px rgba(0, 255, 136, 0.4);
        }

        .body-slot.wrong {
            border-color: #ff4757;
            background: rgba(255, 71, 87, 0.2);
            animation: slotShake 0.5s ease-in-out;
        }

        .body-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
            transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            opacity: 0;
            transform: scale(0.5) rotate(10deg);
        }

        .body-img.appear {
            opacity: 1;
            transform: scale(1) rotate(0deg);
        }

        .body-img.matched {
            border: 3px solid #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        .body-img.disappear {
            opacity: 0;
            transform: scale(0.3) rotate(-10deg);
        }

        .feedback-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 30px;
            font-weight: 900;
            opacity: 0;
            z-index: 30;
            pointer-events: none;
        }

        .feedback-overlay.show {
            opacity: 1;
            animation: feedbackPop 1s ease-in-out;
        }

        .success-feedback {
            background: linear-gradient(135deg, #00ff88 0%, #00d4aa 100%);
            color: white;
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.5);
        }

        .error-feedback {
            background: linear-gradient(135deg, #ff4757 0%, #ff3838 100%);
            color: white;
            box-shadow: 0 10px 30px rgba(255, 71, 87, 0.5);
        }

        .connection-line {
            position: absolute;
            background: linear-gradient(90deg, #00ff88 0%, #00d4aa 100%);
            height: 4px;
            border-radius: 2px;
            transform-origin: left center;
            opacity: 0;
            z-index: 12;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.6);
        }

        .connection-line.draw {
            opacity: 1;
            animation: drawConnection 1s ease-in-out;
        }

        .victory-screen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.95) 0%, rgba(0, 212, 170, 0.95) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            z-index: 50;
            backdrop-filter: blur(15px);
            border-radius: 20px;
        }

        .victory-screen.show {
            opacity: 1;
            animation: victoryFade 1.5s ease-in-out;
        }

        .victory-text {
            font-size: 32px;
            font-weight: 900;
            color: #fff;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .victory-emoji {
            font-size: 80px;
            animation: bounce 2s infinite;
        }

        .particle-system {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 25;
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #ffd700;
            border-radius: 50%;
            opacity: 0;
        }

        .particle.celebrate {
            animation: particleCelebrate 2s ease-out forwards;
        }

        .progress-bar {
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
            overflow: hidden;
            z-index: 20;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff88 0%, #00d4aa 100%);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 3px;
        }

        /* Enhanced animations */
        @keyframes playerPulse {
            0%, 100% { transform: scale(1.15); }
            50% { transform: scale(1.25); }
        }

        @keyframes successGlow {
            0% { transform: scale(1.15); box-shadow: 0 8px 25px rgba(0,0,0,0.4); }
            50% { transform: scale(1.3); box-shadow: 0 15px 40px rgba(0, 255, 136, 0.8); }
            100% { transform: scale(1.15); box-shadow: 0 8px 25px rgba(0,0,0,0.4); }
        }

        @keyframes errorShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes slotShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            75% { transform: translateX(3px); }
        }

        @keyframes feedbackPop {
            0% { transform: translate(-50%, -50%) scale(0.3); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.3); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        @keyframes drawConnection {
            0% { transform: scaleX(0); opacity: 0; }
            100% { transform: scaleX(1); opacity: 1; }
        }

        @keyframes victoryFade {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }

        @keyframes particleCelebrate {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-200px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Game UI */
        .game-ui {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 30;
        }

        .score-display {
            background: rgba(0,0,0,0.4);
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 800;
            font-size: 14px;
            backdrop-filter: blur(10px);
        }

        .restart-btn {
            background: linear-gradient(135deg, #ff4757 0%, #ff3838 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 800;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .restart-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 71, 87, 0.4);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="stadium-bg"></div>
        <div class="field-lines"></div>
        <div class="crowd-effect"></div>
        
        <div class="game-ui">
            <div class="score-display">Score: <span id="score">0</span>/3</div>
            <button class="restart-btn" onclick="restartGame()">Restart</button>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div class="faces-section">
            <div class="player-card">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiNGRkI4N0EiLz4KPGNpcmNsZSBjeD0iMzAiIGN5PSIzMCIgcj0iNCIgZmlsbD0iIzMzMzMzMyIvPgo8Y2lyY2xlIGN4PSI1MCIgY3k9IjMwIiByPSI0IiBmaWxsPSIjMzMzMzMzIi8+CjxwYXRoIGQ9Ik0zNSA1MEMzNSA1MiAzNyA1NCA0MCA1NEMzNCA1NCA0NSA1MiA0NSA1MFoiIGZpbGw9IiMzMzMzMzMiLz4KPHBhdGggZD0iTTI1IDIwQzI1IDE1IDMwIDEwIDQwIDEwQzUwIDEwIDU1IDE1IDU1IDIwVjM1SDI1VjIwWiIgZmlsbD0iIzMzMzMzMyIvPgo8L3N2Zz4K" alt="Messi" class="face-img" id="face1">
                <div class="player-name">Messi</div>
            </div>
            <div class="player-card">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiNGRkI4N0EiLz4KPGNpcmNsZSBjeD0iMzAiIGN5PSIzMCIgcj0iNCIgZmlsbD0iIzMzMzMzMyIvPgo8Y2lyY2xlIGN4PSI1MCIgY3k9IjMwIiByPSI0IiBmaWxsPSIjMzMzMzMzIi8+CjxwYXRoIGQ9Ik0zNSA1MEMzNSA1MiAzNyA1NCA0MCA1NEMzNCA1NCA0NSA1MiA0NSA1MFoiIGZpbGw9IiMzMzMzMzMiLz4KPHBhdGggZD0iTTI1IDIwQzI1IDE1IDMwIDEwIDQwIDEwQzUwIDEwIDU1IDE1IDU1IDIwVjM1SDI1VjIwWiIgZmlsbD0iIzMzMzMzMyIvPgo8L3N2Zz4K" alt="Ronaldo" class="face-img" id="face2">
                <div class="player-name">Ronaldo</div>
            </div>
            <div class="player-card">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iNDAiIGN5PSI0MCIgcj0iNDAiIGZpbGw9IiNGRkI4N0EiLz4KPGNpcmNsZSBjeD0iMzAiIGN5PSIzMCIgcj0iNCIgZmlsbD0iIzMzMzMzMyIvPgo8Y2lyY2xlIGN4PSI1MCIgY3k9IjMwIiByPSI0IiBmaWxsPSIjMzMzMzMzIi8+CjxwYXRoIGQ9Ik0zNSA1MEMzNSA1MiAzNyA1NCA0MCA1NEMzNCA1NCA0NSA1MiA0NSA1MFoiIGZpbGw9IiMzMzMzMzMiLz4KPHBhdGggZD0iTTI1IDIwQzI1IDE1IDMwIDEwIDQwIDEwQzUwIDEwIDU1IDE1IDU1IDIwVjM1SDI1VjIwWiIgZmlsbD0iIzMzMzMzMyIvPgo8L3N2Zz4K" alt="Neymar" class="face-img" id="face3">
                <div class="player-name">Neymar</div>
            </div>
        </div>

        <div class="bodies-section">
            <div class="body-slot" id="slot1">
                <div class="feedback-overlay success-feedback" id="successFeedback1">✓</div>
                <div class="feedback-overlay error-feedback" id="errorFeedback1">✗</div>
            </div>
            <div class="body-slot" id="slot2">
                <div class="feedback-overlay success-feedback" id="successFeedback2">✓</div>
                <div class="feedback-overlay error-feedback" id="errorFeedback2">✗</div>
            </div>
            <div class="body-slot" id="slot3">
                <div class="feedback-overlay success-feedback" id="successFeedback3">✓</div>
                <div class="feedback-overlay error-feedback" id="errorFeedback3">✗</div>
            </div>
        </div>

        <div class="victory-screen" id="victoryScreen">
            <div class="victory-emoji">🏆</div>
            <div class="victory-text">Perfect Match!</div>
        </div>

        <div class="particle-system" id="particleSystem"></div>
    </div>

    <script>
        const kits = [
            'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTAiIGhlaWdodD0iMTQwIiB2aWV3Qm94PSIwIDAgOTAgMTQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cmVjdCB3aWR0aD0iOTAiIGhlaWdodD0iODAiIGZpbGw9IiMwMDMzRkYiLz4KPHN0cmlwZSB4MT0iMCIgeTE9IjIwIiB4Mj0iOTAiIHkyPSIyMCIgc3Ryb2tlPSIjRkZGIiBzdHJva2Utd2lkdGg9IjQiLz4KPHN0cmlwZSB4MT0iMCIgeTE9IjQwIiB4Mj0iOTAiIHkyPSI0MCIgc3Ryb2tlPSIjRkZGIiBzdHJva2Utd2lkdGg9IjQiLz4KPHN0cmlwZSB4MT0iMCIgeTE9IjYwIiB4Mj0iOTAiIHkyPSI2MCIgc3Ryb2tlPSIjRkZGIiBzdHJva2Utd2lkdGg9IjQiLz4KPHJlY3QgeT0iODAiIHdpZHRoPSI5MCIgaGVpZ2h0PSI2MCIgZmlsbD0iIzAwMzNGRiIvPgo8L3N2Zz4K',
            'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTAiIGhlaWdodD0iMTQwIiB2aWV3Qm94PSIwIDAgOTAgMTQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cmVjdCB3aWR0aD0iOTAiIGhlaWdodD0iODAiIGZpbGw9IiNGRkZGRkYiLz4KPHN0cmlwZSB4MT0iMCIgeTE9IjIwIiB4Mj0iOTAiIHkyPSIyMCIgc3Ryb2tlPSIjRkZENzAwIiBzdHJva2Utd2lkdGg9IjQiLz4KPHN0cmlwZSB4MT0iMCIgeTE9IjQwIiB4Mj0iOTAiIHkyPSI0MCIgc3Ryb2tlPSIjRkZENzAwIiBzdHJva2Utd2lkdGg9IjQiLz4KPHN0cmlwZSB4MT0iMCIgeTE9IjYwIiB4Mj0iOTAiIHkyPSI2MCIgc3Ryb2tlPSIjRkZENzAwIiBzdHJva2Utd2lkdGg9IjQiLz4KPHJlY3QgeT0iODAiIHdpZHRoPSI5MCIgaGVpZ2h0PSI2MCIgZmlsbD0iI0ZGRkZGRiIvPgo8L3N2Zz4K',
            'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTAiIGhlaWdodD0iMTQwIiB2aWV3Qm94PSIwIDAgOTAgMTQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cmVjdCB3aWR0aD0iOTAiIGhlaWdodD0iODAiIGZpbGw9IiNGRkZGRkYiLz4KPHN0cmlwZSB4MT0iMCIgeTE9IjIwIiB4Mj0iOTAiIHkyPSIyMCIgc3Ryb2tlPSIjRkYwMDAwIiBzdHJva2Utd2lkdGg9IjQiLz4KPHN0cmlwZSB4MT0iMCIgeTE9IjQwIiB4Mj0iOTAiIHkyPSI0MCIgc3Ryb2tlPSIjRkYwMDAwIiBzdHJva2Utd2lkdGg9IjQiLz4KPHN0cmlwZSB4MT0iMCIgeTE9IjYwIiB4Mj0iOTAiIHkyPSI2MCIgc3Ryb2tlPSIjRkYwMDAwIiBzdHJva2Utd2lkdGg9IjQiLz4KPHJlY3QgeT0iODAiIHdpZHRoPSI5MCIgaGVpZ2h0PSI2MCIgZmlsbD0iI0ZGRkZGRiIvPgo8L3N2Zz4K'
        ];
        
        const correctMatches = [0, 1, 2]; // Messi=kit1, Ronaldo=kit2, Neymar=kit3
        let gameState = {
            currentSlot: 0,
            currentAttempt: 0,
            maxAttempts: 3,
            score: 0,
            isPlaying: false,
            selectedFace: null,
            matches: [false, false, false],
            usedKits: []
        };

        function updateProgress() {
            const progress = (gameState.score / 3) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function updateScore() {
            document.getElementById('score').textContent = gameState.score;
            updateProgress();
        }

        function createParticles(x, y) {
            const particleSystem = document.getElementById('particleSystem');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                particle.style.background = ['#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4'][Math.floor(Math.random() * 5)];
                particle.style.animationDelay = Math.random() * 0.5 + 's';
                particle.style.animationDuration = Math.random() * 1.5 + 1 + 's';
                
                particleSystem.appendChild(particle);
                particle.classList.add('celebrate');
                
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 2000);
            }
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function drawConnectionLine(fromElement, toElement) {
            const fromRect = fromElement.getBoundingClientRect();
            const toRect = toElement.getBoundingClientRect();
            const container = document.querySelector('.game-container');
            const containerRect = container.getBoundingClientRect();
            
            const fromX = fromRect.left + fromRect.width / 2 - containerRect.left;
            const fromY = fromRect.top + fromRect.height / 2 - containerRect.top;
            const toX = toRect.left + toRect.width / 2 - containerRect.left;
            const toY = toRect.top + toRect.height / 2 - containerRect.top;
            
            const distance = Math.sqrt(Math.pow(toX - fromX, 2) + Math.pow(toY - fromY, 2));
            const angle = Math.atan2(toY - fromY, toX - fromX) * 180 / Math.PI;
            
            const line = document.createElement('div');
            line.className = 'connection-line';
            line.style.left = fromX + 'px';
            line.style.top = fromY + 'px';
            line.style.width = distance + 'px';
            line.style.transform = `rotate(${angle}deg)`;
            
            container.appendChild(line);
            
            setTimeout(() => {
                line.classList.add('draw');
            }, 100);
            
            return line;
        }

        function showFeedback(slotIndex, isCorrect) {
            const feedbackId = isCorrect ? `successFeedback${slotIndex + 1}` : `errorFeedback${slotIndex + 1}`;
            const feedback = document.getElementById(feedbackId);
            
            feedback.classList.add('show');
            setTimeout(() => {
                feedback.classList.remove('show');
            }, 1000);
        }

        function placeKitInSlot(slotIndex, kitIndex) {
            const slot = document.getElementById(`slot${slotIndex + 1}`);
            const existingImg = slot.querySelector('.body-img');
            
            if (existingImg) {
                existingImg.classList.add('disappear');
                setTimeout(() => {
                    existingImg.remove();
                }, 300);
            }
            
            setTimeout(() => {
                const img = document.createElement('img');
                img.src = kits[kitIndex];
                img.className = 'body-img';
                img.alt = `Kit ${kitIndex + 1}`;
                slot.appendChild(img);
                
                setTimeout(() => {
                    img.classList.add('appear');
                }, 50);
            }, existingImg ? 300 : 0);
        }

        function handleMatch(faceIndex, slotIndex) {
            const isCorrect = correctMatches[faceIndex] === slotIndex;
            const face = document.getElementById(`face${faceIndex + 1}`);
            const slot = document.getElementById(`slot${slotIndex + 1}`);
            
            if (isCorrect) {
                // Correct match
                gameState.matches[faceIndex] = true;
                gameState.score++;
                gameState.usedKits.push(slotIndex);
                
                face.classList.add('correct-match');
                slot.classList.add('matched');
                
                placeKitInSlot(slotIndex, slotIndex);
                
                const connectionLine = drawConnectionLine(face, slot);
                showFeedback(slotIndex, true);
                
                setTimeout(() => {
                    const img = slot.querySelector('.body-img');
                    if (img) {
                        img.classList.add('matched');
                    }
                }, 500);
                
                createParticles(
                    slot.getBoundingClientRect().left + slot.offsetWidth / 2 - document.querySelector('.game-container').getBoundingClientRect().left,
                    slot.getBoundingClientRect().top + slot.offsetHeight / 2 - document.querySelector('.game-container').getBoundingClientRect().top
                );
                
                updateScore();
                
                if (gameState.score === 3) {
                    setTimeout(() => {
                        showVictory();
                    }, 1500);
                }
            } else {
                // Wrong match
                face.classList.add('wrong-match');
                slot.classList.add('wrong');
                
                showFeedback(slotIndex, false);
                
                setTimeout(() => {
                    face.classList.remove('wrong-match');
                    slot.classList.remove('wrong');
                }, 600);
            }
            
            // Reset face selection
            setTimeout(() => {
                face.classList.remove('selected', 'correct-match', 'wrong-match');
                gameState.selectedFace = null;
            }, 1000);
        }

        function showVictory() {
            const victoryScreen = document.getElementById('victoryScreen');
            victoryScreen.classList.add('show');
            
            // Create victory particles
            createParticles(200, 300);
            setTimeout(() => createParticles(150, 250), 300);
            setTimeout(() => createParticles(250, 350), 600);
        }

        function resetGame() {
            gameState = {
                currentSlot: 0,
                currentAttempt: 0,
                maxAttempts: 3,
                score: 0,
                isPlaying: false,
                selectedFace: null,
                matches: [false, false, false],
                usedKits: []
            };
            
            // Clear all slots
            for (let i = 1; i <= 3; i++) {
                const slot = document.getElementById(`slot${i}`);
                const img = slot.querySelector('.body-img');
                if (img) {
                    img.remove();
                }
                slot.classList.remove('matched', 'wrong');
            }
            
            // Clear all faces
            for (let i = 1; i <= 3; i++) {
                const face = document.getElementById(`face${i}`);
                face.classList.remove('selected', 'correct-match', 'wrong-match');
            }
            
            // Clear connection lines
            const lines = document.querySelectorAll('.connection-line');
            lines.forEach(line => line.remove());
            
            // Hide victory screen
            document.getElementById('victoryScreen').classList.remove('show');
            
            // Reset score and progress
            updateScore();
        }

        function restartGame() {
            resetGame();
        }

        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateScore();
            
            // Add click handlers for faces
            for (let i = 1; i <= 3; i++) {
                const face = document.getElementById(`face${i}`);
                face.addEventListener('click', function() {
                    if (gameState.matches[i - 1]) return; // Already matched
                    
                    // Deselect previous face
                    if (gameState.selectedFace !== null) {
                        const prevFace = document.getElementById(`face${gameState.selectedFace + 1}`);
                        prevFace.classList.remove('selected');
                    }
                    
                    // Select new face
                    gameState.selectedFace = i - 1;
                    face.classList.add('selected');
                });
            }
            
            // Add click handlers for slots
            for (let i = 1; i <= 3; i++) {
                const slot = document.getElementById(`slot${i}`);
                slot.addEventListener('click', function() {
                    if (gameState.selectedFace === null) return;
                    if (gameState.usedKits.includes(i - 1)) return; // Slot already used
                    
                    handleMatch(gameState.selectedFace, i - 1);
                });
            }
        });
    </script>
</body>
</html>
