<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drawing SpongeBob - Realistic Hand-Drawn Animation</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Bebas Neue', cursive;
            background: #f9f5ec;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            width: 100vw;
            height: 100vh;
            max-width: 563px;
            max-height: 1000px;
            position: relative;
            background: #f9f5ec;
            aspect-ratio: 9/16;
        }
        
        #backgroundCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        #spongebob-svg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 350px;
            z-index: 2;
        }
        
        .intro-text {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            z-index: 10;
            opacity: 0;
            animation: fadeInOut 3s ease-in-out;
        }
        
        .final-text {
            position: absolute;
            bottom: 15%;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            z-index: 10;
            opacity: 0;
            text-align: center;
        }
        
        .pencil {
            position: absolute;
            width: 60px;
            height: 15px;
            z-index: 5;
            opacity: 0;
            transition: all 0.1s ease;
        }
        
        .glow-effect {
            filter: drop-shadow(0 0 10px rgba(255, 255, 0, 0.5));
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; }
            30% { opacity: 1; }
            70% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        @keyframes glow {
            from { filter: drop-shadow(0 0 10px rgba(255, 255, 0, 0.5)); }
            to { filter: drop-shadow(0 0 20px rgba(255, 255, 0, 0.8)); }
        }
        
        .bounce {
            animation: bounce 0.5s ease-in-out;
        }
        
        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .zoom-in {
            animation: zoomIn 3s ease-in-out;
        }
        
        @keyframes zoomIn {
            0% { transform: translate(-50%, -50%) scale(1); }
            100% { transform: translate(-50%, -50%) scale(1.1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <canvas id="backgroundCanvas"></canvas>
        
        <div class="intro-text">DRAWING SPONGEBOB...</div>
        
        <svg id="spongebob-svg" viewBox="0 0 300 350">
            <!-- SpongeBob Body -->
            <path id="body" d="M75 80 Q75 60 95 60 L205 60 Q225 60 225 80 L225 200 Q225 220 205 220 L95 220 Q75 220 75 200 Z" 
                  fill="none" stroke="#777" stroke-width="3"/>
            
            <!-- SpongeBob Eyes -->
            <circle id="left-eye" cx="120" cy="110" r="25" fill="none" stroke="#777" stroke-width="3"/>
            <circle id="right-eye" cx="180" cy="110" r="25" fill="none" stroke="#777" stroke-width="3"/>
            <circle id="left-pupil" cx="120" cy="110" r="8" fill="none" stroke="#777" stroke-width="2"/>
            <circle id="right-pupil" cx="180" cy="110" r="8" fill="none" stroke="#777" stroke-width="2"/>
            
            <!-- SpongeBob Nose -->
            <path id="nose" d="M145 125 Q150 130 155 125" fill="none" stroke="#777" stroke-width="2"/>
            
            <!-- SpongeBob Mouth -->
            <path id="mouth" d="M130 150 Q150 170 170 150" fill="none" stroke="#777" stroke-width="3"/>
            
            <!-- SpongeBob Pants -->
            <rect id="pants" x="85" y="180" width="130" height="60" fill="none" stroke="#777" stroke-width="3"/>
            
            <!-- SpongeBob Tie -->
            <path id="tie" d="M140 170 L160 170 L155 190 L145 190 Z" fill="none" stroke="#777" stroke-width="2"/>
            
            <!-- SpongeBob Arms -->
            <path id="left-arm" d="M75 140 Q50 135 45 150 Q50 165 75 160" fill="none" stroke="#777" stroke-width="3"/>
            <path id="right-arm" d="M225 140 Q250 135 255 150 Q250 165 225 160" fill="none" stroke="#777" stroke-width="3"/>
            
            <!-- SpongeBob Legs -->
            <path id="left-leg" d="M110 240 L110 290 Q110 300 120 300 L130 300" fill="none" stroke="#777" stroke-width="3"/>
            <path id="right-leg" d="M190 240 L190 290 Q190 300 180 300 L170 300" fill="none" stroke="#777" stroke-width="3"/>
            
            <!-- Sponge holes -->
            <circle id="hole1" cx="100" cy="90" r="4" fill="none" stroke="#777" stroke-width="2"/>
            <circle id="hole2" cx="130" cy="85" r="3" fill="none" stroke="#777" stroke-width="2"/>
            <circle id="hole3" cx="170" cy="90" r="4" fill="none" stroke="#777" stroke-width="2"/>
            <circle id="hole4" cx="200" cy="85" r="3" fill="none" stroke="#777" stroke-width="2"/>
            <circle id="hole5" cx="105" cy="160" r="3" fill="none" stroke="#777" stroke-width="2"/>
            <circle id="hole6" cx="195" cy="165" r="4" fill="none" stroke="#777" stroke-width="2"/>
        </svg>
        
        <svg class="pencil" id="pencil">
            <rect x="0" y="5" width="45" height="5" fill="#f4d03f"/>
            <polygon points="45,5 60,7.5 45,10" fill="#8b4513"/>
            <circle cx="52" cy="7.5" r="1" fill="#333"/>
        </svg>
        
        <div class="final-text">LIKE IF YOU LOVE SPONGEBOB! üçç</div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vivus@latest/dist/vivus.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/roughjs@4.3.1/bundled/rough.js"></script>
    
    <script>
       class SpongeBobAnimator {
    constructor() {
        this.canvas = null;
        this.ctx = null;
        this.pencil = null;
        this.currentPhase = 'intro';
        this.phaseStartTime = 0;
        this.isInitialized = false;
        this.animationFrame = null;
        this.vivusInstances = new Map();
        
        // Animation configuration
        this.config = {
            timeline: {
                intro: { start: 0, end: 3000 },
                sketch: { start: 3000, end: 10000 },
                inking: { start: 10000, end: 18000 },
                coloring: { start: 18000, end: 27000 },
                final: { start: 27000, end: 30000 }
            },
            colors: {
                body: '#FFD700',
                eyes: '#FFFFFF',
                pupils: '#000080',
                pants: '#8B4513',
                tie: '#FF0000'
            },
            pencil: {
                radius: 50,
                speed: 0.1
            }
        };
        
        this.init();
    }
    
    async init() {
        this.setupEventListeners();
        await this.waitForDOM();
        this.setupP5Background();
        setTimeout(() => this.initializeAnimation(), 100);
    }
    
    waitForDOM() {
        return new Promise(resolve => {
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', resolve);
            } else {
                resolve();
            }
        });
    }
    
    setupEventListeners() {
        window.addEventListener('resize', this.debounce(this.handleResize.bind(this), 250));
        window.addEventListener('beforeunload', this.cleanup.bind(this));
    }
    
    setupP5Background() {
        if (typeof createCanvas === 'undefined') {
            console.warn('p5.js not loaded, skipping background setup');
            return;
        }
        
        window.setup = () => {
            const container = document.querySelector('.container');
            if (!container) return;
            
            this.canvas = createCanvas(container.offsetWidth, container.offsetHeight);
            this.canvas.parent('backgroundCanvas');
            
            this.createPaperTexture();
            noLoop();
        };
        
        window.draw = () => {
            // p5.js background rendering
        };
        
        window.windowResized = () => {
            const container = document.querySelector('.container');
            if (container && this.canvas) {
                resizeCanvas(container.offsetWidth, container.offsetHeight);
                this.createPaperTexture();
            }
        };
    }
    
    createPaperTexture() {
        background(249, 245, 236);
        
        // Use more efficient rendering
        for (let x = 0; x < width; x += 3) {
            for (let y = 0; y < height; y += 3) {
                if (Math.random() > 0.7) { // Reduce density for performance
                    const brightness = this.randomBetween(240, 255);
                    const alpha = this.randomBetween(10, 30);
                    fill(brightness, brightness, brightness, alpha);
                    noStroke();
                    circle(
                        x + this.randomBetween(-1, 1), 
                        y + this.randomBetween(-1, 1), 
                        this.randomBetween(0.5, 2)
                    );
                }
            }
        }
    }
    
    async initializeAnimation() {
        if (this.isInitialized) return;
        this.isInitialized = true;
        
        this.pencil = document.getElementById('pencil');
        if (!this.pencil) {
            console.error('Pencil element not found');
            return;
        }
        
        try {
            await this.executeAnimationSequence();
        } catch (error) {
            console.error('Animation sequence failed:', error);
        }
    }
    
    async executeAnimationSequence() {
        const phases = [
            { delay: 3000, method: this.startSketchPhase.bind(this) },
            { delay: 10000, method: this.startInkingPhase.bind(this) },
            { delay: 18000, method: this.startColoringPhase.bind(this) },
            { delay: 27000, method: this.startFinalReveal.bind(this) }
        ];
        
        phases.forEach(({ delay, method }) => {
            setTimeout(method, delay);
        });
    }
    
    createRoughSketch() {
        const svg = document.getElementById('spongebob-svg');
        if (!svg || typeof roughjs === 'undefined') {
            console.warn('SVG element or rough.js not found');
            return;
        }
        
        const rough = roughjs.svg(svg);
        const paths = svg.querySelectorAll('path, circle, rect');
        
        paths.forEach(path => {
            try {
                if (path.tagName === 'path') {
                    const d = path.getAttribute('d');
                    if (d) {
                        const roughPath = rough.path(d, {
                            stroke: '#777',
                            strokeWidth: 3,
                            roughness: 2,
                            bowing: 1
                        });
                        path.parentNode?.replaceChild(roughPath, path);
                    }
                }
            } catch (error) {
                console.warn('Failed to create rough sketch for element:', path, error);
            }
        });
    }
    
    startSketchPhase() {
        this.createRoughSketch();
        this.setPencilVisibility(true);
        
        if (typeof Vivus !== 'undefined') {
            this.vivusInstances.set('sketch', new Vivus('spongebob-svg', {
                type: 'delayed',
                duration: 140,
                start: 'manual',
                animTimingFunction: Vivus.EASE_OUT
            }, () => {
                this.setPencilVisibility(false);
            }));
            
            this.vivusInstances.get('sketch').play();
        }
        
        this.animatePencil();
    }
    
    startInkingPhase() {
        this.applyInkStyling();
        this.setPencilVisibility(true);
        
        if (typeof Vivus !== 'undefined') {
            this.vivusInstances.set('ink', new Vivus('spongebob-svg', {
                type: 'sync',
                duration: 80,
                start: 'manual'
            }, () => {
                this.setPencilVisibility(false);
                this.pencil?.classList.add('bounce');
            }));
            
            this.vivusInstances.get('ink').play();
        }
        
        this.animatePencil();
    }
    
    applyInkStyling() {
        const elements = document.querySelectorAll('#spongebob-svg path, #spongebob-svg circle, #spongebob-svg rect');
        elements.forEach(element => {
            Object.assign(element.style, {
                stroke: '#111',
                strokeWidth: '2',
                transition: 'stroke 0.3s ease, stroke-width 0.3s ease'
            });
        });
    }
    
    async startColoringPhase() {
        const colorSequence = [
            { delay: 500, id: 'body', color: this.config.colors.body },
            { delay: 1000, id: 'left-eye', color: this.config.colors.eyes },
            { delay: 1200, id: 'right-eye', color: this.config.colors.eyes },
            { delay: 1400, id: 'left-pupil', color: this.config.colors.pupils },
            { delay: 1600, id: 'right-pupil', color: this.config.colors.pupils },
            { delay: 2000, id: 'pants', color: this.config.colors.pants },
            { delay: 2500, id: 'tie', color: this.config.colors.tie },
            { delay: 3000, id: 'left-arm', color: this.config.colors.body },
            { delay: 3200, id: 'right-arm', color: this.config.colors.body },
            { delay: 3500, id: 'left-leg', color: this.config.colors.body },
            { delay: 3700, id: 'right-leg', color: this.config.colors.body }
        ];
        
        colorSequence.forEach(({ delay, id, color }) => {
            setTimeout(() => this.fillElement(id, color), delay);
        });
    }
    
    fillElement(id, color) {
        const element = document.getElementById(id);
        if (element) {
            Object.assign(element.style, {
                fill: color,
                transition: 'fill 0.5s ease'
            });
        }
    }
    
    startFinalReveal() {
        const svg = document.getElementById('spongebob-svg');
        const finalText = document.querySelector('.final-text');
        
        svg?.classList.add('glow-effect', 'zoom-in');
        
        if (finalText) {
            Object.assign(finalText.style, {
                opacity: '1',
                animation: 'fadeInOut 3s ease-in-out'
            });
        }
    }
    
    animatePencil() {
        if (!this.pencil) return;
        
        const svg = document.getElementById('spongebob-svg');
        const container = document.querySelector('.container');
        
        if (!svg || !container) return;
        
        const svgRect = svg.getBoundingClientRect();
        const containerRect = container.getBoundingClientRect();
        
        let angle = 0;
        const { radius, speed } = this.config.pencil;
        const centerX = svgRect.left + svgRect.width / 2 - containerRect.left;
        const centerY = svgRect.top + svgRect.height / 2 - containerRect.top;
        
        const movePencil = () => {
            if (this.pencil.style.opacity === '1') {
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                
                Object.assign(this.pencil.style, {
                    left: `${x}px`,
                    top: `${y}px`,
                    transform: `rotate(${angle * 180 / Math.PI + 45}deg)`
                });
                
                angle += speed;
                this.animationFrame = requestAnimationFrame(movePencil);
            }
        };
        
        movePencil();
    }
    
    setPencilVisibility(visible) {
        if (this.pencil) {
            this.pencil.style.opacity = visible ? '1' : '0';
        }
    }
    
    handleResize() {
        if (typeof windowResized === 'function') {
            windowResized();
        }
    }
    
    cleanup() {
        if (this.animationFrame) {
            cancelAnimationFrame(this.animationFrame);
        }
        
        this.vivusInstances.forEach(vivus => {
            if (vivus && typeof vivus.destroy === 'function') {
                vivus.destroy();
            }
        });
        
        this.vivusInstances.clear();
    }
    
    // Utility methods
    randomBetween(min, max) {
        return Math.random() * (max - min) + min;
    }
    
    debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }
}

// Initialize the animator
const spongeBobAnimator = new SpongeBobAnimator();
    </script>
</body>
</html>
